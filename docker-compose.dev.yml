# version: '3.8'
services:
    api:
        ports:
            - "8000:8000"
        volumes:
            - ./api:/code
        env_file: .env_dev
        deploy:
            resources:
                limits:
                    memory: 3G

    postgres:
        ports:
            - "9802:5432"
        restart: always
        volumes:
          - /dbpool/ubuntu/db_data/:/data
        deploy:
          resources:
            limits:
              memory: 2G

    # worker:                                                                                                                                                                                                    
    #     volumes:                                                                                                                                                                                              
    #         - ./api:/code                                                                                                                                                                                      
    #     env_file: .env_dev                                                                                                                                                                                     
    #     restart: always

    web:
        ports:
            - "8001:8001"
        volumes:
            - ./web:/code
        env_file: .env_dev
        deploy:
            resources:
                limits:
                    memory: 3G